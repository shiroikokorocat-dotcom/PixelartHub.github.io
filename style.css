@font-face {
    font-family: 'Kenney Future';
    src: url('assets/ui/Font/Kenney%20Future.ttf') format('truetype');
    font-display: swap;
}
@font-face {
    font-family: 'Fool';
    src: url('assets/ui/Font/Fool.ttf') format('truetype');
    font-display: swap;
}
@font-face {
    font-family: 'Kenney Future Narrow';
    src: url('assets/ui/Font/Kenney%20Future%20Narrow.ttf') format('truetype');
    font-display: swap;
}

#fondo-mosaico {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
    pointer-events: none;
    /* Fondo agrupado */
    background-image: url('assets/bg/fondo.png');
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center center;
    image-rendering: pixelated;
}

body {
    font-family: 'Kenney Future', Arial, sans-serif;
    color: #fff;
    text-align: center;
    background: none;
    overflow-y: scroll; /* barra lateral siempre activa */
    overflow-x: hidden; /* evita desbordes horizontales accidentales */
}
h1 {
    margin: 8px 0 6px 0; /* reduce espacio vertical del título */
    font-size: clamp(26px, 4.5vw, 56px);
    line-height: 1.1;
    font-weight: 700;
    font-family: 'Kenney Future Narrow', 'Kenney Future', system-ui, Arial, sans-serif; /* usar Kenney para título */
    position: relative;
    z-index: 2; /* por encima del canvas y el grid */
    /* contorno para legibilidad sobre el fondo */
    text-shadow:
        2px 0 0 #000,
        -2px 0 0 #000,
        0 2px 0 #000,
        0 -2px 0 #000,
        1px 1px 0 #000,
        -1px 1px 0 #000,
        1px -1px 0 #000,
        -1px -1px 0 #000,
        0 0 10px rgba(0,0,0,0.5);
}
#info-panel .header h2 {
    font-family: 'Kenney Future', system-ui, Arial, sans-serif; /* fuente Kenney para subtítulo */
    letter-spacing: 0.5px;
}
#canvas-container {
    display: inline-block;
    position: relative;
    z-index: 1; /* por encima de las nubes (canvas fixed con z-index:0) */
    margin-top: 8px; /* baja un poco la grid debajo del título */
    max-width: 100vw; /* no exceder el viewport */
    overflow: hidden; /* recorte de desbordes accidentales */
}
#pixelart-canvas {
    border: 2px solid #555;
    background: #111;
    cursor: pointer;
}
.ground {
    image-rendering: pixelated;
    background:
        linear-gradient(#4caf50, #4caf50) top/100% 4px no-repeat,  /* capa de pasto */
        repeating-linear-gradient(
            to bottom,
            #6b472a 0px,
            #6b472a 2px,
            #5b3d24 2px,
            #5b3d24 4px
        ); /* tierra con bandas */
    border-top: 2px solid #2e7d32; /* borde de pasto más oscuro */
}

/* pequeños pastos (matas) pixeladas */
.grass-tuft {
    position: absolute;
    width: 2px;  /* tamaño base de pixel */
    height: 2px;
    background: #66bb6a; /* verde principal */
    image-rendering: pixelated;
    pointer-events: none;
    /* dibuja hojas laterales y altura con sombras en bloques de 2px */
    box-shadow:
        0 -2px #66bb6a,
        0 -4px #66bb6a,
        -2px -2px #5aa65e,
        2px -2px #5aa65e,
        -2px 0 #58a15c,
        2px 0 #58a15c;
}

/* flores pixeladas con pétalos en cruz y pequeño tallo */
.flower {
    position: absolute;
    width: 2px;
    height: 2px;
    background: var(--fl, #ffd54f); /* color de pétalo */
    image-rendering: pixelated;
    pointer-events: none;
    box-shadow:
        -2px 0 var(--fl, #ffd54f),
        2px 0 var(--fl, #ffd54f),
        0 -2px var(--fl, #ffd54f),
        0 2px var(--fl, #ffd54f),
        0 4px #2e7d32; /* tallo verde */
}
/* ondulaciones de pasto que caen sobre la tierra */
.grass-overhang {
    position: absolute;
    width: 2px;
    height: 4px; /* se ajustará por inline style */
    background: #4caf50;
    image-rendering: pixelated;
    pointer-events: none;
    box-shadow:
        0 1px 0 rgba(0,0,0,0.15);
}
/* piedras pixeladas en el piso */
.stone {
    position: absolute;
    width: 2px;
    height: 2px;
    background: var(--st, #8d8d8d);
    image-rendering: pixelated;
    pointer-events: none;
    /* forma compacta 3x3 aprox usando bloques de 2px */
    box-shadow:
        2px 0   var(--st, #8d8d8d),
        0   2px var(--st, #8d8d8d),
        2px 2px var(--st, #8d8d8d),
        -2px 0  var(--st, #8d8d8d);
}
.stone.multi {
    /* multicolor: colores provistos por variables */
    background: var(--c1, #c66);
    box-shadow:
        2px 0   var(--c2, #e6a23c),
        0   2px var(--c3, #6fcf97),
        2px 2px var(--c4, #56ccf2),
        -2px 0  var(--c5, #bb6bd9);
    will-change: filter;
    animation: iridescent-shift 2.8s linear infinite;
}
/* diamante (rombo de 5 bloques) */
.stone.diamond {
    background: var(--di, #cfe9ff);
    box-shadow:
        2px 0   var(--di, #cfe9ff),
        -2px 0  var(--di, #cfe9ff),
        0   2px var(--di, #cfe9ff),
        0  -2px var(--di, #cfe9ff);
    will-change: filter;
    animation: diamond-sparkle 1.8s ease-in-out infinite;
}

/* Animación de brillo para diamantes */
@keyframes diamond-sparkle {
    0%, 100% { filter: brightness(1) saturate(1) drop-shadow(0 0 0 rgba(200, 235, 255, 0)); }
    50% { filter: brightness(1.35) saturate(1.15) drop-shadow(0 0 6px rgba(200, 235, 255, 0.9)); }
}

/* Efecto tornasol (iridiscente) para multicolor */
@keyframes iridescent-shift {
    0%   { filter: hue-rotate(0deg)   saturate(1.1) brightness(1.0) drop-shadow(0 0 0 rgba(255,255,255,0.15)); }
    25%  { filter: hue-rotate(90deg)  saturate(1.25) brightness(1.05) drop-shadow(0 0 2px rgba(255,255,255,0.25)); }
    50%  { filter: hue-rotate(180deg) saturate(1.3)  brightness(1.08) drop-shadow(0 0 3px rgba(255,255,255,0.3)); }
    75%  { filter: hue-rotate(270deg) saturate(1.25) brightness(1.04) drop-shadow(0 0 2px rgba(255,255,255,0.25)); }
    100% { filter: hue-rotate(360deg) saturate(1.1)  brightness(1.0) drop-shadow(0 0 0 rgba(255,255,255,0.15)); }
}
/* Overlay absoluto para no afectar el grid */
#info-panel {
    position: absolute;
    left: 50%;
    bottom: 0;
    transform: translateX(-50%);
    width: 80vw;
    max-width: 700px;
    /* Ajustes configurables para el nombre */
    --name-min-px: 30;   /* tamaño mínimo en px */
    --name-max-px: 64;   /* tamaño máximo en px */
    --name-initial-px: 40; /* tamaño inicial al mostrar */
    --name-two-line-threshold-px: 40; /* si el tamaño cae por debajo, usar 2 líneas */
    /* Fracción de la columna izquierda en móvil (ajustable por JS si se desea) */
    --left-col-frac: 44%;
    background: transparent; /* textura de fondo en ::before */
    padding: 20px 30px 30px 30px;
    border-radius:20px;
    box-shadow: 0 -2px 8px #0006;
    display: block;
    min-width: 250px;
    z-index: 1001;
    color: #fff;
    font-size: 1.1em;
    text-align: left;
    position: fixed;
    overflow: hidden; /* recorta la textura al panel */
    box-sizing: border-box; /* que el ancho incluya padding y borde para no desbordar */
    /* transiciones ultra rápidas (50ms) para cambios veloces de personaje */
    transition: bottom 50ms ease-out, opacity 50ms ease-out;
    will-change: bottom, opacity;
    /* Marco 9-slice usando Madera/Default */
    border: 16px solid transparent;
    /*-webkit-border-image: url('assets/ui/PNG/Madera/Default/button_rectangle_line.png') 16 fill round;*/
    border-image: url('assets/ui/PNG/Madera/Default/button_rectangle_line.png') 5 fill round;
    image-rendering: pixelated;
}
#info-panel::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    image-rendering: pixelated;
    z-index: 0; /* detrás del contenido */
    /* Textura base: madera pixelart (se puede cambiar por un tile del paquete UI) */
    background:
        /* Vetillas verticales sutiles */
        repeating-linear-gradient(
            to right,
            rgba(0,0,0,0.10) 0px,
            rgba(0,0,0,0.10) 1px,
            transparent 1px,
            transparent 4px
        ),
        /* Planchas horizontales con separadores */
        repeating-linear-gradient(
            to bottom,
            #5b3a23 0px,    /* borde superior oscuro */
            #5b3a23 1px,
            #7a5032 1px,    /* relleno de madera */
            #7a5032 20px,
            #613f29 20px,   /* línea separadora */
            #613f29 21px,
            #744a2f 21px,   /* siguiente tabla */
            #744a2f 40px,
            #5b3a23 40px,
            #5b3a23 41px
        );
    background-blend-mode: multiply;
}
#info-panel .info-content { position: relative; z-index: 1; }
#info-panel .info-content {
    display: grid;
    grid-template-columns: auto 6px minmax(0, 1fr); /* 3ra columna flexible sin desbordes */
    align-items: start;
    align-content: start; /* no estirar verticalmente */
    row-gap: 12px;
    column-gap: 6px; /* margen lateral más estrecho para el divisor */
    max-width: 100%;
    width: 100%; /* ocupar todo el ancho disponible del panel */
    overflow-x: hidden; /* evitar desbordes horizontales internos */
}
#panel-close.panel-close {
    position: absolute;
    top: 6px;
    right: 6px;
    z-index: 2;
    width: 28px;
    height: 28px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-family: 'Kenney Future', system-ui, sans-serif;
    font-size: 0; /* ocultar el glifo '✕' y usar icono */
    line-height: 1;
    color: transparent;
    cursor: pointer;
    border: none;
    -webkit-border-image: none;
    border-image: none;
    background:  url('assets/ui/PNG/Madera/Default/icon_cross.png') center center no-repeat;
    background-size: 22px 22px; /* tamaño del icono */
    image-rendering: pixelated;
}
#panel-close.panel-close:hover {
    filter: brightness(1.15);
    background-image: url('assets/ui/PNG/Madera/Default/icon_outline_cross.png');
}
#panel-close.panel-close:active { filter: brightness(0.9); }
#info-panel .info-left {
    display: flex;
    align-items: flex-start;   /* colocar arriba */
    justify-content: flex-start; /* y a la izquierda */
    padding: 1px; /* espacio extra alrededor del personaje */
    flex-direction: column;
     /* Importante para que la columna pueda contraerse en pantallas estrechas
         y no empuje/solape el divisor vertical */
     min-width: 0;
     max-width: 100%;
    box-sizing: border-box;
    /* Evita desbordes horizontales hacia el divisor pero permite que sombras verticales se vean */
    overflow-x: hidden;
    overflow-y: visible;
}

/* Paleta de colores bajo el sprite */
.palette { width: 85%; margin-top: 2px; background: rgba(0,0,0,0.12); border: 1px solid #3a3a3a; box-shadow: inset 0 0 0 1px #00000055; padding: 4px 6px; box-sizing: border-box; overflow: hidden; position: relative; }
.palette-title { font-size: 8px; text-transform: uppercase; opacity: 0.9; margin-bottom: 4px; letter-spacing: 0.5px; }
.palette-swatches { display: grid; grid-template-columns: repeat(auto-fill, 14px); gap: 4px; width: 100%; max-width: 100%; overflow: hidden; justify-content: start; align-content: start; }
.swatch {
    width: 14px; /* igual al track de la grid */
    height: 14px;
    box-sizing: border-box; /* incluye el borde dentro del tamaño declarado */
    border: 1px solid #222;
    box-shadow: inset 0 0 0 1px #00000055;
    image-rendering: pixelated;
}

#segment-preview {
    width: auto;                 /* conservar proporción */
    max-width: var(--preview-max-vw, 70vw); /* límite horizontal (corregido a vw) */
    height: min(var(--preview-max-vh, var(--sprite-max-vh, 50vh)), 100vh); /* escalar hacia arriba hasta el tope de vh */
    display: block; /* elimina gap de imagen inline */
    image-rendering: pixelated;
    background: rgba(0, 0, 0, 0.5); /* fondo medianamente transparente */
    border: 4px solid #333;
    margin: 8px 0; /* espaciado compacto */
    box-sizing: border-box; /* evita que el borde haga overflow de la columna */
}
/* estado de carga similar al PFP */
#segment-preview.preview-loading {
    background: linear-gradient(90deg, #1f1f1f 0%, #2a2a2a 50%, #1f1f1f 100%);
    background-size: 200% 100%;
    animation: pfp-shimmer 1.2s linear infinite;
}
.stats {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 4px;           /* más compacto entre filas */
    margin: 4px 0 0 0;  /* más pegado al PFP */
    border: 1px solid #3a3a3a;   /* marco fino */
    box-shadow: inset 0 0 0 1px #00000066; /* realce interno sutil */
    background: rgba(0,0,0,0.15);
    padding: 3px 4px;   /* aún más compacto */
    box-sizing: border-box; /* evita que el borde/padding ensanche más de la columna */
}
.stats-title {
    font-size: 8px;     /* título ligeramente más pequeño */
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #f0f0f0;
    opacity: 0.9;
}
.stat-row {
    display:flex; align-items:center;
    gap: 6px;           /* menos espacio horizontal */
    font-size: 5px;
}
.stat-row .stat-label {
    color:#dcdcdc;
    text-align: right;
    width: 24px;         /* un poco más estrecha */
    font-size: 9px;      /* más compacto */
}
.stat-row .stat-bar {
    flex: 1;
    height: 2px;          /* grosor 2px (ajustable a 1px si se desea) */
    background:#151515;   /* carril oscuro */
    position: relative;
}
.stat-row .stat-bar .fill {
    position:absolute; left:0; top:0; bottom:0;
    width:0%;
    background: #7cb342;  /* se sobrescribe por JS según porcentaje */
    image-rendering: pixelated;
}
.stat-row .stat-value { display:none; }
#info-panel .divider {
    position: relative;
    width: 6px; /* ajuste al tile de madera */
    height: auto;
    align-self: stretch;
    image-rendering: pixelated;
    overflow: hidden; /* recorta el relleno rotado */
    pointer-events: none;
}

/* Relleno rotado 90° dentro del divisor vertical */
#info-panel .divider .divider-rot {
    position: absolute;
    /* expandir ampliamente para cubrir tras rotación y evitar cortes */
    top: -1000%;
    bottom: -1000%;
    left: -2260px;
    right: -2260px;
    display: block;
    background: url('assets/ui/PNG/Madera/Default/divider.png') center center repeat-x;
    background-size: auto 100%;
    transform: rotate(90deg);
    transform-origin: center center;
    image-rendering: pixelated;
}

#info-panel .divider::before,
#info-panel .divider::after {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    height: 8px; /* alto de la tapa de madera */
    image-rendering: pixelated;
    background: url('assets/ui/PNG/Madera/Default/divider_edges.png') center center no-repeat;
    background-size: contain;
    pointer-events: none;
}
#info-panel .divider::before { top: -2px; transform: translateX(-50%) rotate(-90deg); }
#info-panel .divider::after  { bottom: -2px; transform: translateX(-50%) rotate(90deg); }

/* Horizontal wooden divider (reusable) */
.divider-h {
    position: relative;
    height: 6px;
    width: 100%;
    image-rendering: pixelated;
    background: url('assets/ui/PNG/Madera/Default/divider.png') center left repeat-x;
    background-size: auto 100%;
    pointer-events: none;
}
.divider-h::before,
.divider-h::after {
    content: '';
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 8px;
    height: 100%;
    image-rendering: pixelated;
    background: url('assets/ui/PNG/Madera/Default/divider_edges.png') center center no-repeat;
    background-size: contain;
    pointer-events: none;
}
.divider-h::before { left: -1px; transform: translateY(-50%) rotate(-90deg); }
.divider-h::after  { right: -1px; transform: translateY(-50%) rotate(90deg); }
#info-panel .info-right {
    display: grid;
    grid-template-columns: 80px minmax(0, 1fr); /* evitar desbordes horizontales */
    grid-template-areas:
        "profile header"
        "dividerH dividerH"
        "stats   socials";
    grid-template-rows: auto auto 1fr;
    gap: 12px 16px;
    min-width: 0; /* permitir que el grid se contraiga dentro del panel */
    align-content: start; /* evitar estiramiento vertical */
    grid-auto-rows: min-content; /* filas con alto mínimo requerido */
    max-width: 100%;
    overflow: hidden; /* evita desbordes hacia la derecha */
    justify-self: stretch; /* ocupar todo el ancho de su columna */
    width: 100%;
}
/* Horizontal divider sits in its own named row spanning both columns */
#info-panel .info-right .divider-h { grid-area: dividerH; margin: 4px 0; }
#info-panel .info-right .header,
#info-panel .info-right .meta,
#info-panel .info-right #stats { min-width: 0; max-width: 100%; overflow: hidden; }
#info-panel .header { grid-area: header; display:flex; align-items:center; gap:12px; min-width:0; overflow:hidden; }
#info-panel .header h2 {
    margin: 0;
    font-size: var(--name-initial-px, 28px); /* tamaño base configurado */
    flex: 1 1 auto;    /* ocupar el espacio disponible */
    min-width: 0;      /* permitir que flex reduzca el ancho */
    width: 100%;       /* asegurar que tome todo el ancho del header */
    max-width: 100%;
    padding-right: 6px; /* margen de seguridad para evitar cortes al borde derecho */
    white-space: nowrap;        /* en una línea */
    overflow: hidden;           /* cortar exceso */
    text-overflow: ellipsis;    /* puntos suspensivos si no cabe */
    overflow-wrap: anywhere;    /* seguridad adicional ante textos largos sin espacios */
}
/* Variante a 2 líneas con clamp */
#info-panel .header h2.two-line {
    white-space: normal;
    display: -webkit-box;
    line-clamp: 2;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.15;
    word-break: break-word;
    overflow-wrap: anywhere;
}
#social-links { display:flex; flex-direction: column; gap:6px; align-items:flex-start; width: 100%; }
.social-row { display:flex; align-items:center; gap:6px; width: 100%; min-width: 0; }
.social-row .site-label { color:#e0e0e0; font-weight: 700; font-size: 11px; width: 28px; text-align: right; opacity: 0.9; }
#social-links .social {
    color:#000;
    text-decoration: underline;
    font-family: 'Fool', 'Kenney Future', system-ui, Arial, sans-serif;
    font-size: 0.95em;
    display: inline-block;
    max-width: 100%;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    /* Fondo estilo UI para resaltar el texto */
    padding: 2px 2px;
    border: 4px solid transparent;
    -webkit-border-image: url('assets/ui/PNG/Madera/Default/input_outline_rectangle.png') 10 fill round;
    border-image: url('assets/ui/PNG/Madera/Default/input_outline_rectangle.png') 10 fill round;
    image-rendering: pixelated;
}
#social-links .social:hover { filter: brightness(1.1); }
#info-panel a,
#info-panel a:visited { color: #000; }
#info-panel a:hover { color: #000; }
#social-links .hidden { display:none; }
#preview-controls.dev-controls { margin-top: 8px; padding-top: 8px; border-top: 1px dashed rgba(255,255,255,0.2); display:flex; flex-direction: column; gap:8px; }
#preview-controls .control-title { font-size: 10px; text-transform: uppercase; opacity: 0.9; letter-spacing: 0.5px; }
#preview-controls .control-row { display:grid; grid-template-columns: 92px 1fr 44px; align-items:center; gap:8px; }
#preview-controls label { font-size: 11px; color:#eaeaea; }
#preview-controls input[type="range"] { width: 100%; }
#preview-controls .control-val { font-size: 11px; color:#ddd; text-align:right; min-width:44px; }
#info-panel .profile { grid-area: profile; align-self: start; }
#pfp-image {
    width: 80px;
    height: 80px;
    max-height: 20vh; /* pequeña salvaguarda en pantallas muy bajas/altas */
    object-fit: cover;
    border:1px solid #333;
    background:#222;
    display:block;
}
#pfp-image.pfp-loading {
    background: linear-gradient(90deg, #242424 0%, #333333 50%, #242424 100%);
    background-size: 200% 100%;
    animation: pfp-shimmer 1.2s linear infinite;
}

@keyframes pfp-shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}
#info-panel .meta { grid-area: socials; display:flex; flex-direction: column; gap:8px; }
#info-panel #stats { grid-area: stats; }
#info-panel.hidden {
    display: none;
}
#user-image {
    max-width: 100px;
    border-radius: 8px;
    margin-bottom: 10px;
}

img {
    box-shadow:
        0 1px 8px rgba(0, 0, 0, 0.267), /* sombra externa más sutil */
        0 0 0 5px #0002 inset; /* sombra interna más suave */
    border-radius: 8px;
    margin-bottom: 10px;
    max-width: 100%;
    height: auto;
}
.highlight {
    box-shadow: 0 0 0 4px #ff0, 0 0 10px #ff0;
}

/* utilidades */
.hidden { display: none !important; }

/* Avatar PFP volador */
.pfp-flyer {
    position: fixed;
    width: 72px;
    height: 72px;
    object-fit: cover;
    border: 1px solid #333;
    background: #222;
    border-radius: 10px;
    box-shadow: 0 6px 14px rgba(0,0,0,0.35);
    /* Debe verse delante de las nubes (z:0) y detrás de los personajes (contenedor z:1) */
    z-index: 0;
    pointer-events: none;
    will-change: transform;
}

/* =====================
   Debug de divisiones
   ===================== */
#info-panel.debug { outline: 2px dashed rgba(255,255,0,0.6); outline-offset: 2px; }
#info-panel.debug .info-content { position: relative; }
#info-panel.debug .info-left,
#info-panel.debug .divider,
#info-panel.debug .info-right { position: relative; }

#info-panel.debug .info-left { background: rgba(0, 255, 255, 0.06); box-shadow: inset 0 0 0 1px rgba(0,255,255,0.6); }
#info-panel.debug .divider   { background: rgba(255, 0, 0, 0.10);  box-shadow: inset 0 0 0 1px rgba(255,0,0,0.7); }
#info-panel.debug .info-right{ background: rgba(0, 255, 0, 0.06); box-shadow: inset 0 0 0 1px rgba(0,255,0,0.6); }

/* Etiquetas de debug para columnas principales */
#info-panel.debug .info-left::after,
#info-panel.debug .divider::after,
#info-panel.debug .info-right::after {
    position: absolute;
    top: -10px;
    left: 0;
    font-size: 10px;
    color: #ff0;
    text-shadow: 1px 1px 0 #000, -1px -1px 0 #000;
}
#info-panel.debug .info-left::after { content: 'info-left'; }
#info-panel.debug .divider::after   { content: 'divider (vertical)'; }
#info-panel.debug .info-right::after{ content: 'info-right'; }

/* Áreas internas dentro de info-right */
#info-panel.debug .info-right .header,
#info-panel.debug .info-right .profile,
#info-panel.debug .info-right .divider-h,
#info-panel.debug #stats,
#info-panel.debug .meta { position: relative; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.4); }

#info-panel.debug .info-right .header { background: rgba(255, 165, 0, 0.10); }
#info-panel.debug .info-right .profile{ background: rgba(135, 206, 235, 0.10); }
#info-panel.debug .info-right .divider-h{ background-color: rgba(255, 0, 255, 0.15); }
#info-panel.debug #stats             { background: rgba(173, 255, 47, 0.10); }
#info-panel.debug .meta              { background: rgba(216, 191, 216, 0.10); }

#info-panel.debug .info-right .header::before,
#info-panel.debug .info-right .profile::before,
#info-panel.debug .info-right .divider-h::before,
#info-panel.debug #stats::before,
#info-panel.debug .meta::before {
    content: attr(data-area);
    position: absolute;
    top: -10px;
    left: 0;
    font-size: 10px;
    color: #0ff;
    text-shadow: 1px 1px 0 #000, -1px -1px 0 #000;
}

/* Nombres por defecto si no hay data-area */
#info-panel.debug .info-right .header::before   { content: 'header'; }
#info-panel.debug .info-right .profile::before  { content: 'profile'; }
#info-panel.debug .info-right .divider-h::before{ content: 'divider-h'; }
#info-panel.debug #stats::before               { content: 'stats'; }
#info-panel.debug .meta::before                { content: 'socials/meta'; }

/* Debug global: resaltar secciones principales en la pantalla */
body.debug h1 { outline: 2px dashed rgba(0,255,255,0.6); outline-offset: 2px; }
body.debug #canvas-container { outline: 2px dashed rgba(255,0,255,0.6); outline-offset: 2px; position: relative; }
body.debug #nubes-canvas { outline: 2px dashed rgba(0,255,0,0.6); outline-offset: 2px; }
body.debug #fondo-mosaico { outline: 2px dashed rgba(255,165,0,0.6); outline-offset: 2px; }
body.debug #info-panel { outline: 2px dashed rgba(255,255,0,0.6); outline-offset: 2px; }

/* ====== Placeholder de redes sociales ====== */
#social-links .social-placeholder {
    margin-top: 2px;
    color: #000;
    font-family: 'Fool', 'Kenney Future', system-ui, Arial, sans-serif;
    font-size: 12px;
    opacity: 0.9;
    padding: 4px 8px;
    display: inline-block;
    border: 2px solid rgba(255,255,255,0.5);
    box-shadow:
        0 0 0 2px rgba(6,26,49,0.95) inset,
        0 0 0 6px rgba(255,255,255,0.08) inset;
    image-rendering: pixelated;
    background: rgba(229, 219, 212, 0.8); /* igual que el fondo de .social */
}

/* =====================
   Pantalla de carga
   ===================== */
#loading-screen {
    position: fixed;
    inset: 0;
    background: #0a2342; /* azul marino */
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 20000; /* por encima del panel */
    opacity: 1;
    transition: opacity 220ms ease-out, visibility 220ms ease-out;
}
#loading-screen.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}
#loading-screen.locked { pointer-events: auto; }
#loading-screen .loader-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    text-align: center;
    user-select: none;
}
/* Barra de progreso: rectángulo con borde y un espacio interno de 3px */
#loading-screen .progress {
    width: min(86vw, 860px);
    padding: 6px;
    /* Borde CSS usando tonos del fondo (sin recursos UI) */
    border: 2px solid rgba(255,255,255,0.35);
    box-shadow:
        0 0 0 2px rgba(6,26,49,0.95) inset,   /* borde interno oscuro */
        0 0 0 6px rgba(255,255,255,0.08) inset, /* segunda línea clara */
        0 2px 0 rgba(0,0,0,0.35);            /* leve drop para relieve */
    background: rgba(0,0,0,0.2);
}
#loading-screen .progress-track {
    position: relative;
    height: 16px;
    background: #000; /* carril negro */
    box-shadow: 0 0 0 3px #0a2342 inset; /* espacio interno de 3px en contraste con el fondo */
    overflow: hidden;
}
#loading-screen .progress-line {
    position: absolute;
    left: 3px;
    top: 3px;
    bottom: 3px;
    width: 0%;
    background: #fff; /* línea blanca */
    box-shadow: 0 0 0 1px #ccc inset;
}
#loading-screen .loader-text { font-family: 'Kenney Future Narrow', 'Kenney Future', system-ui, Arial, sans-serif; font-size: 16px; }
#loading-screen .loader-sub  { font-family: 'Fool', 'Kenney Future', system-ui, Arial, sans-serif; font-size: 12px; opacity: 0.9; }
/* Dots animados tipo "saltitos" */
#loader-text .dot { display: inline-block; animation: dot-bounce 1.2s infinite; transform-origin: bottom center; }
#loader-text .dot:nth-child(1) { animation-delay: 0s; }
#loader-text .dot:nth-child(2) { animation-delay: 0.15s; }
#loader-text .dot:nth-child(3) { animation-delay: 0.3s; }
@keyframes dot-bounce {
    0%, 20%, 100% { transform: translateY(0); }
    10% { transform: translateY(-3px); }
}
/* Botón Start con estilo pixel art */
#loading-screen .loader-cta {
    margin-top: 6px;
    padding: 6px 14px;
    font-family: 'Kenney Future', 'Kenney Future Narrow', system-ui, Arial, sans-serif;
    font-size: 16px;
    color: #000;
    background: #f1f1f1; /* relleno claro; se mantiene, solo bordes sin recursos UI */
    border: 2px solid rgb(226, 226, 226);
    /* Marco pixelado con sombras en capas usando tonos del loader */
    box-shadow:
        0 0 0 2px rgba(7,29,56,0.95) inset,  /* línea oscura interna */
        0 0 0 6px rgba(255,255,255,0.08) inset, /* línea clara adicional */
        0 2px 0 rgba(0,0,0,0.5);            /* sombra inferior para relieve */
    cursor: pointer;
    filter: drop-shadow(1px 3px 0 rgba(0, 0, 0, 0.533));
}
#loading-screen .loader-cta:hover { filter: brightness(1.08) drop-shadow(0 2px 0 #0008); }
#loading-screen .loader-cta:active { filter: brightness(0.92) drop-shadow(0 1px 0 #0008); }
#loading-screen .loader-logo {
    position: relative;
    width: min(86vw, 860px);
    height: 128px; /* área para varias filas */
    overflow: hidden;
    image-rendering: pixelated;
    /* Borde CSS-only, tonos del fondo */
    border: 2px solid rgba(255,255,255,0.35);
    box-shadow:
        0 0 0 2px rgba(6,26,49,0.95) inset,
        0 0 0 6px rgba(255,255,255,0.08) inset,
        0 2px 0 rgba(0,0,0,0.35);
    background: rgba(255,255,255,0.04);
    /* Variables para controlar el sangrado lateral (para que la desaparición ocurra fuera del recuadro) y el gap entre repeticiones */
    --edge-bleed: 48px;
    --gap: 48px;
}
#loading-screen .word-lane {
    position: absolute;
    left: calc(-1 * var(--edge-bleed, 48px));
    right: calc(-1 * var(--edge-bleed, 48px));
    height: 26px;
    line-height: 26px;
    font-family: 'Fool', 'Kenney Future', system-ui, Arial, sans-serif;
    font-size: 18px;
    color: #fff;
    opacity: 0.9;
    white-space: nowrap;
}
#loading-screen .word-lane .scroll {
    display: inline-block; /* se ajusta al ancho del contenido duplicado */
    will-change: transform;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    animation-duration: var(--dur, 12s);
    font-size: 0; /* elimina espacios entre los spans duplicados */
}
#loading-screen .word-lane.ltr .scroll { animation-name: marquee-left; }
#loading-screen .word-lane.rtl .scroll { animation-name: marquee-right; }
#loading-screen .word-lane .content { display: inline-block; padding-right: 0; font-size: 18px; }

/* sutil variación por fila */
#loading-screen .word-lane:nth-child(1) { opacity: 0.95; }
#loading-screen .word-lane:nth-child(2) { opacity: 0.85; }
#loading-screen .word-lane:nth-child(3) { opacity: 0.90; }
#loading-screen .word-lane:nth-child(4) { opacity: 0.8; }

@keyframes marquee-left {
    0%   { transform: translate3d(0, 0, 0); }
    100% { transform: translate3d(calc(-1 * var(--pxDist, 600px)), 0, 0); }
}
@keyframes marquee-right {
    0%   { transform: translate3d(calc(-1 * var(--pxDist, 600px)), 0, 0); }
    100% { transform: translate3d(0, 0, 0); }
}
/* Marco para el texto de carga con el mismo box model que el botón Start */
.loader-text-frame {
    margin-top: 6px;
    padding: 6px 14px;
    font-family: 'Silkscreen', system-ui, Arial, sans-serif;
    font-size: 16px;
    color: #000;
    background: #f1f1f1;
    border: 2px solid rgb(226, 226, 226);
    box-shadow:
        0 0 0 2px rgba(7,29,56,0.95) inset,
        0 0 0 6px rgba(255,255,255,0.08) inset,
        0 2px 0 rgba(0,0,0,0.5);
    /* Igual altura que el botón; no clickable */
    cursor: default;
    user-select: none;
    min-width: 96px; /* asegura un ancho mínimo comparable a "Start" */
}
/* Tipografías del texto y subtítulo del loader */
#loading-screen .loader-text { font-family: 'Kenney Future Narrow', 'Kenney Future', system-ui, Arial, sans-serif; font-size: 16px; }
#loading-screen .loader-sub  { font-family: 'Fool', 'Kenney Future', system-ui, Arial, sans-serif; font-size: 12px; opacity: 0.9; }

/* =====================
   Ajustes móviles (pantallas altas)
   Evita que .info-left empuje/solape el divisor
   ===================== */
@media (max-aspect-ratio: 5/6) {
    /* Limitar la altura del panel al 40% de la pantalla en móvil */
    #info-panel {
        max-height: 40vh;
    }
    /* Hacer que el contenido interno sea scrollable dentro del límite */
    #info-panel .info-content {
        max-height: calc(40vh - 82px); /* 16(top border)+16(bottom border)+20(top padding)+30(bottom padding) */
        overflow-y: auto;
        width: 100%;
        /* Izquierda crece gradualmente hasta 50% (el resto lo asume la derecha) */
        grid-template-columns: minmax(0, clamp(36%, var(--left-col-frac, 44%), 50%)) 6px minmax(0, 1fr);
    }
    #info-panel .info-left,
    #info-panel .info-right {
        min-width: 0;
    max-width: 100%;
    width: 100%;
    }
    /* Asegurar que los hijos no desborden la columna izquierda */
    #segment-preview { max-width: 100%; height: auto; }
    #palette { width: 100%; }
    /* Paleta: ocupar todo el ancho en una sola fila, ajustando el tamaño automáticamente */
    .palette-swatches {
        display: grid;
    grid-template-columns: repeat(var(--swatch-cols, var(--swatch-count, 1)), minmax(0, 1fr));
        gap: 4px;
        width: 100%;
        overflow: hidden; /* sin scroll horizontal */
    }
    .swatch {
        width: 100%;
        height: auto;
        aspect-ratio: 1 / 1; /* cuadrado, crece hasta llenar el ancho disponible */
    }
}
